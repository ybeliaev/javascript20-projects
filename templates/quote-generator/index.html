<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href=" http://www.google.com/s2/favicons?domain=javascript20-projects">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@4/distr/fira_code.css">
    <link rel="stylesheet" href="./style.css">
    <title>Quote generator</title>
</head>

<body>
    <div class="quote-container" id="quote-container">
        <div class="quote-text">
            <i class="fas fa-quote-left"></i>
            <span id="quote">
                Ты глаза свои видел? В них мысли нет... никакой...
            </span>
        </div>

        <div class="quote-author">
            <span id="author">
                Гвидон Вишневский
            </span>
        </div>
        <div class="button-container">
            <button class="twitter-button" id="twitter" title="Tweet this!">
                <i class="fab fa-twitter"></i>
            </button>
            <button class="new-qoute">New quote</button>
        </div>

        <!-- end container -->
    </div>
    <div class="alert">
        <pre><code>
            // Get Quote From API
            async function getQuote() {
                const apiUrl = 'https://api.forismatic.com/api/1.0/?method=getQuote&lang=ru&format=json';
                try {
                    const response = await fetch(apiUrl);
                    const data = await response.json;
                    console.log(data)
                } catch (error) {
                    console.log("Опс..нет цитаты!", error)
                }
            }

            // On Load
            getQuote();
        </code></pre>
        <p>Но не сработает из-за CORS. Поэтому иду в <code>https://github.com/Rob--W/cors-anywhere/</code> и беру там
            <code>https://cors-anywhere.herokuapp.com/</code></p>
        <p>Теперь переписать <code>response</code>: <code>const response = await fetch(proxyUrl + apiUrl)</code>; где
            <code>const proxyUrl = 'https://jacinto-cors-proxy.herokuapp.com/';</code></p>
        <p>Теперь работает <span style='font-size:20px;'>&#127752;</span> </p>
        <p>Чтобы в случае <code>SyntaxError</code> не прерывалось исполнение, добавлю <code>getQuote()</code> в
            обработчик ошибок</p>
        <pre><code>
            // Get Quote From API
            async function getQuote() {
                // We need to use a Proxy URL to make our API call in order to avoid a CORS error
                const proxyUrl = 'https://jacinto-cors-proxy.herokuapp.com/';
                const apiUrl = 'https://api.forismatic.com/api/1.0/?method=getQuote&lang=ru&format=json';
                try {
                    const response = await fetch(proxyUrl + apiUrl);
                    const data = await response.json();
                    console.log(data)
                } catch (error) {
                    getQuote();
                    console.log("Опс..нет цитаты!", error)
                }
            }

            // On Load
            getQuote();
        </code></pre>
    </div>

    <script src="./scripts.js"></script>
</body>

</html>